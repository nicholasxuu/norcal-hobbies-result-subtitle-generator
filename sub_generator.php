<?php

require_once("core.php");
require_once("result_analyzer.php");

/***
 * subtitle creation
 */

$race_name = "2wd Buggy 17.5 A Main                                         Round# 3, Race# 5";
$racer_number = 7;
$init_time = 1.6;
$video_len = "0:05:25.0";
$race_minutes = 5;
$output_file_name = "C:\\Users\\Nicholas\\Videos\\RC\\20130327-Others-17.5TBuggy-EX-MAH00248.ass";
$input = $sample_input_6;

$ass_format = "
[Script Info]
; Script generated by Aegisub 3.0.2
; http://www.aegisub.org/
Title:
Original Script:
Script Updated By: version 2.8.01
ScriptType: v4.00+
Collisions: Normal
PlayDepth: 0
Timer: 100,0000
Video Aspect Ratio: c1.77778
Video Zoom: 6
Scroll Position: 0
Active Line: 0
Video Zoom Percent: 0.5
Video File: 
YCbCr Matrix: TV.601

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: DefaultVCD,Andale Mono,8,&H00B4FCFC,&H00B4FCFC,&H01000008,&H80000008,-1,0,0,0,100,100,0,0,1,1,0,9,5,5,5,0

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
";

$total_data = result_analyzer($input);
//echo var_dump($total_data);

$ass_output = $ass_format;

//$ass_output = get_personal_ass($total_data, $race_name, $racer_number, $init_time, $ass_format);


$ass_output .= get_all_live_info_ass($total_data, $race_name, $init_time, $race_minutes, "\\an7");
//echo $ass_output;
//echo var_dump($ass_output);

$ass_output .= get_timer_ass($init_time, $race_minutes, $total_data, $race_name, "\\an8\\fscx150\\fscy150\\fnQuartz MS");

if (1) {
$fp = fopen($output_file_name, "w");
fwrite($fp, $ass_output);
fclose($fp);
}